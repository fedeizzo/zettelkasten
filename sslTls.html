<!DOCTYPE html><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><meta content="width=device-width, initial-scale=1" name="viewport" /><!--replace-start-0--><!--replace-start-5--><!--replace-start-8--><title>SSL and TLS - Federico Izzo&#39;s personal Zettelkasten</title><!--replace-end-8--><!--replace-end-5--><!--replace-end-0--><link href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.7/dist/semantic.min.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Merriweather|Libre+Franklin|Roboto+Mono&amp;display=swap" rel="stylesheet" /><!--replace-start-1--><!--replace-start-4--><!--replace-start-7--><link href="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" rel="icon" /><meta content="Federico Izzo" name="author" /><meta content="SSL, Secure Sockets Layer, developed as a way to secure communications between the client and server on the web (1990s by Netscape). The currently version is SSLv3, others are deprecated." name="description" /><link href="https://fedeizzo.github.io/sslTls.html" rel="canonical" /><meta content="SSL and TLS" property="og:title" /><meta content="Federico Izzo&#39;s personal Zettelkasten" property="og:site_name" /><meta content="article" property="og:type" /><meta content="https://fedeizzo.github.io/static/tlsProtocols.png" property="og:image" /><script type="application/ld+json">[{"@context":"https://schema.org","itemListElement":[{"name":"Privacy","item":"https://fedeizzo.github.io/privacy.html","@type":"ListItem","position":1},{"name":"Cryptology","item":"https://fedeizzo.github.io/cryptography.html","@type":"ListItem","position":2},{"name":"Asymmetric key encryption","item":"https://fedeizzo.github.io/asymmetricKeyEncryption.html","@type":"ListItem","position":3}],"@type":"BreadcrumbList"},{"@context":"https://schema.org","itemListElement":[{"name":"Digital certificates","item":"https://fedeizzo.github.io/digitalCertificate.html","@type":"ListItem","position":1}],"@type":"BreadcrumbList"}]</script><style type="text/css">body{background-color:#eeeeee !important;font-family:"Libre Franklin", serif !important}body .ui.container{font-family:"Libre Franklin", serif !important}body h1, h2, h3, h4, h5, h6, .ui.header, .headerFont{font-family:"Merriweather", sans-serif !important}body code, pre, tt, .monoFont{font-family:"Roboto Mono","SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace !important}body div.z-index p.info{color:#808080}body div.z-index ul{list-style-type:square;padding-left:1.5em}body div.z-index .uplinks{margin-left:0.29999em}body .zettel-content h1#title-h1{background-color:rgba(27,28,29,0.1)}body nav.bottomPane{background-color:rgba(27,28,29,2.0e-2)}body div#footnotes{border-top-color:#1b1c1d}body p{line-height:150%}body img{max-width:100%}body .deemphasized{font-size:0.94999em}body .deemphasized:hover{opacity:1}body .deemphasized:not(:hover){opacity:0.69999}body .deemphasized:not(:hover) a{color:#808080 !important}body div.container.universe{padding-top:1em}body div.zettel-view ul{padding-left:1.5em;list-style-type:square}body div.zettel-view .pandoc .highlight{background-color:#ffff00}body div.zettel-view .pandoc .ui.disabled.fitted.checkbox{margin-right:0.29999em;vertical-align:middle}body div.zettel-view .zettel-content .metadata{margin-top:1em}body div.zettel-view .zettel-content .metadata div.date{text-align:center;color:#808080}body div.zettel-view .zettel-content h1{padding-top:0.2em;padding-bottom:0.2em;text-align:center}body div.zettel-view .zettel-content h2{border-bottom:solid 1px #4682b4;margin-bottom:0.5em}body div.zettel-view .zettel-content h3{margin:0px 0px 0.4em 0px}body div.zettel-view .zettel-content h4{opacity:0.8}body div.zettel-view .zettel-content div#footnotes{margin-top:4em;border-top-style:groove;border-top-width:2px;font-size:0.9em}body div.zettel-view .zettel-content div#footnotes ol > li > p:only-of-type{display:inline;margin-right:0.5em}body div.zettel-view .zettel-content aside.footnote-inline{width:30%;padding-left:15px;margin-left:15px;float:right;background-color:#d3d3d3}body div.zettel-view .zettel-content .overflows{overflow:auto}body div.zettel-view .zettel-content code{margin:auto auto auto auto;font-size:100%}body div.zettel-view .zettel-content p code, li code, ol code{padding:0.2em 0.2em 0.2em 0.2em;background-color:#f5f2f0}body div.zettel-view .zettel-content pre{overflow:auto}body div.zettel-view .zettel-content dl dt{font-weight:bold}body div.zettel-view .zettel-content blockquote{background-color:#f9f9f9;border-left:solid 10px #cccccc;margin:1.5em 0px 1.5em 0px;padding:0.5em 10px 0.5em 10px}body div.zettel-view .zettel-content.raw{background-color:#dddddd}body .ui.label.zettel-tag{color:#000000}body .ui.label.zettel-tag a{color:#000000}body nav.bottomPane ul.backlinks > li{padding-bottom:0.4em;list-style-type:disc}body nav.bottomPane ul.context-list > li{list-style-type:lower-roman}body .footer-version img{-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);-ms-filter:grayscale(100%);-o-filter:grayscale(100%);filter:grayscale(100%)}body .footer-version img:hover{-webkit-filter:grayscale(0%);-moz-filter:grayscale(0%);-ms-filter:grayscale(0%);-o-filter:grayscale(0%);filter:grayscale(0%)}body .footer-version, .footer-version a, .footer-version a:visited{color:#808080}body .footer-version a{font-weight:bold}body .footer-version{margin-top:1em !important;font-size:0.69999em}@media only screen and (max-width: 768px){body div#zettel-container{margin-left:0.4em !important;margin-right:0.4em !important}}body span.zettel-link-container span.zettel-link a{color:#1b1c1d;font-weight:bold;text-decoration:none}body span.zettel-link-container span.zettel-link a:hover{background-color:rgba(27,28,29,0.1)}body span.zettel-link-container span.extra{color:auto}body span.zettel-link-container.errors{border:solid 1px #ff0000}body span.zettel-link-container.errors span.zettel-link a:hover{text-decoration:none !important;cursor:not-allowed}body [data-tooltip]:after{font-size:0.69999em}body div.tag-tree div.node{font-weight:bold}body div.tag-tree div.node a.inactive{color:#555555}body .tree.flipped{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}body .tree{overflow:auto}body .tree ul.root{padding-top:0px;margin-top:0px}body .tree ul{position:relative;padding:1em 0px 0px 0px;white-space:nowrap;margin:0px auto 0px auto;text-align:center}body .tree ul::after{content:"";display:table;clear:both}body .tree ul:last-child{padding-bottom:0.1em}body .tree li{display:inline-block;vertical-align:top;text-align:center;list-style-type:none;position:relative;padding:1em 0.5em 0em 0.5em}body .tree li::before{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{right:auto;left:50%;border-left:solid 2px #cccccc}body .tree li:only-child{padding-top:0em}body .tree li:only-child::after{display:none}body .tree li:only-child::before{display:none}body .tree li:first-child::before{border-style:none;border-width:0px}body .tree li:first-child::after{border-radius:5px 0px 0px 0px}body .tree li:last-child::after{border-style:none;border-width:0px}body .tree li:last-child::before{border-right:solid 2px #cccccc;border-radius:0px 5px 0px 0px}body .tree ul ul::before{content:"";position:absolute;top:0px;left:50%;border-left:solid 2px #cccccc;width:0px;height:1.19999em}body .tree li div.forest-link{border:solid 2px #cccccc;padding:0.2em 0.29999em 0.2em 0.29999em;text-decoration:none;display:inline-block;border-radius:5px 5px 5px 5px;color:#333333;position:relative;top:2px}body .tree.flipped li div.forest-link{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}</style><script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" rel="stylesheet" /><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/autoloader/prism-autoloader.min.js"></script><!--replace-end-7--><!--replace-end-4--><!--replace-end-1--></head><body><div class="ui fluid container universe"><!--replace-start-2--><!--replace-start-3--><!--replace-start-6--><nav class="flipped tree deemphasized" id="zettel-uptree" style="transform-origin: 50%"><ul class="root"><li><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-01-04T09:02"><a href="asymmetricKeyEncryption.html">Asymmetric key encryption</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2020-12-12T10:38"><a href="cryptography.html">Cryptology</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2020-12-30T14:20"><a href="privacy.html">Privacy</a></span></span></div></li></ul></li></ul></li><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2020-01-14T14:59"><a href="digitalCertificate.html">Digital certificates</a></span></span></div></li></ul></li></ul></nav><div class="ui text container" id="zettel-container" style="position: relative"><div class="zettel-view"><article class="ui raised attached segment zettel-content"><div class="pandoc"><h1 id="title-h1">SSL and TLS</h1><p>SSL, Secure Sockets Layer, developed as a way to secure communications between the client and server on the web (1990s by Netscape). The currently version is SSLv3, others are deprecated.</p><p>TLS, Transport Layer Security, has same protocol design to SSL but with different algorithms. The primary goal of TLS is to provide privacy and data integrity between two communication applications, nowadays used to protect information transmitted between browsers and Web Servers. The currently version is TLS 1.3.</p><p>A field in which SSL &amp; TLS is HTTPS. It provides:</p><ul><li>authentication of the website and associated web server with which one is communicating</li><li>protection against man-in-the-middle-attack</li><li>bidirectional encryption of communications between a client and server</li><li>protection against eavesdropping and tampering with the contents of the communication</li></ul><h3 id="architectures">Architectures</h3><p>The most used architecture in which TLS is used is <strong>client-server</strong>, there are multiple clients that communicate with a single server. In this case <strong>Transmission Control Protocol (TCP)</strong> is used in order to establish a two-way connection between a server and a single client; it provides reliable byte stream transmission of data with error checking and correction, and message acknowledgement.</p><p>TLS is composed by two main protocols:</p><ul><li><em><strong>handshake</strong></em> protocol → use public-key cryptography to establish a shared secret key between the client and the server;</li><li><em><strong>record</strong></em> protocol → use the secret key established in the handshake protocol to protect communication between the client and the server.</li></ul><p><img alt="TLS protocols" class="ui image centered" src="./static/tlsProtocols.png" /></p><p>There are also some additional protocols:</p><ul><li><em><strong>TLS change cipher</strong></em> protocol → used to change the encryption being used by the client and the server. Normally used as part of the handshake process to switch to symmetric key encryption;</li><li><em><strong>TLS alert</strong></em> protocol → used to report cause of failure.</li></ul><h3 id="handshake">Handshake</h3><p><img alt="TLS Handshake" class="ui image centered" src="./static/tlsHandshake.png" /></p><ol><li>Client send Hello message containing:<ul><li>version of the protocol</li><li>list of supported cipher suite<span data-nosnippet=""><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></span></li></ul></li><li>Server send Hello message containing:<ul><li>chosen protocol</li><li>chosen cipher suite</li><li>session ID</li></ul></li><li>Server send three messages (during this phase RSA or DH are used and TLS verifies server’s digital certificate):<ul><li>certificate in X.509 standard (if client request it)</li><li>server key exchange, used to generate the master key</li><li>certificate request (if server requires the client to be authenticated)</li></ul></li><li>Client send three messages (during this phase RSA or DH are used and TLS verifies client’s digital certificate):<ul><li>certificate in X.509 standard (if server send a certificate request)</li><li>client key exchange (same as above)</li><li>certificate verify, message that provides explicit verification of the client certificate</li></ul></li><li>Server and client send two messages (server before client):<ul><li>change cipher spec</li><li>hash of the entire handshake process</li></ul></li><li>message from client is now encrypted</li><li>message from server is now encrypted</li></ol><h3 id="tls-authentication">TLS authentication</h3><p>There are two authentication:</p><ul><li>server-side → client uses the server’s public key to encrypt the data that is used to compute the secret key. The server can generate the secret key only if it can decrypt that data with the correct private key.</li><li>client-side → server uses the public key in the client certificate to decrypt the data the client sends during step 4 of the handshake process. The exchange of finished messages that are encrypted with the secret key confirms that authentication is complete.</li></ul><p>In order to verify the certification during step 3 and 4 TLS verifies:</p><ol><li>digital signature</li><li>certificate chain checking intermediate CA certificates</li><li>expiry, activation dates and the validity period</li><li>revocation status of the certificate</li></ol><h4 id="tls-confidentiality">TLS confidentiality</h4><p>TLS is based on asymmetric key for exchange operation in which the symmetric key and the symmetric algorithm is chosen. For this reason there is not the possibility to break the confidentiality.</p><h4 id="tls-integrity">TLS integrity</h4><p>TLS provides data integrity by calculating a message digest. For this stage hash algorithm is used.</p><h3 id="tls-vulnerabilities">TLS vulnerabilities</h3><p>There are some vulnerabilities dues to backward compatibility and logical flaws. Three attacks on TLS are listed:</p><ul><li><em><strong>POODLE</strong></em> → based on a man-in-the-middle attack in which the hacker tells to the client he doesn’t support TLS. At this point client propose SSL 3.0 and hacker forward message to the server that write back to the client “yes”. Now hacker can use a SSL 3.0 vulnerability.</li><li><em><strong>CRIME</strong></em> → manipulation of cookies in order to get some content from them.</li><li><em><strong>HEARTBLEED</strong></em> → the client sends a heartbeat to the server with a payload that contain data and the size of data. Server responds with the same heartbeat request. If client sends an heartbeat with wrong size server responds filling the empty space with random data from server memory and it can contain credentials, sensitive information, etc.</li></ul><h2 id="tls-13">TLS 1.3</h2><p>TLS 1.3 was born to remove some unsafe and unused features from previous version. It also improve security and performance maintaining a backward compatibility.</p><h3 id="faster-handshake">Faster handshake</h3><p><img alt="TLS 1.3 handshake" class="ui image centered" src="./static/tls13Handshake.png" /></p><h3 id="cipher-suites">Cipher suites</h3><p>Cipher suites was reduced from 319 to 5. It was also removed the possibility to perform “renegotiation”. Renegotiation consist in a new exchange of parameters and keys for communication.</p><h3 id="forward-secrecy">Forward secrecy</h3><p>Forward secrecy is a feature of specific key agreement protocols that ensure session keys will not be compromised even if long-term secrets used in the session key exchange are compromised. This is possibile because:</p><ul><li>a new session key is generated every session a user initiates;</li><li>zero round-trip-time modality which set RTT to zero during handshake that ensure better site performance;</li><li>adoption of ephemeral Diffie-Hellman over RSA for keys exchange. An extension of the Diffie-Hellman method that uses different key for each connection<span data-nosnippet=""><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup></span>.</li></ul><div id="footnotes"><ol><li id="fn1"><p>A cipher suite is a set of algorithms that help secure a network connection that uses TLS. It includes key exchange algorithm, bulk encryption algorithm and a message authentication code (MAC) algorithm. It can also include signatures and an authentication algorithm to help authenticate the server or the client.</p><a href="#fnref1">↩︎</a></li><li id="fn2"><p>Ephemeral Diffie-Hellman differs from the standard (static) DH because standard one use always the same private keys. For this reason the shared secret key is always the same. Ephemeral generates new key for every connection and thus the same key is never used twice. Mainly for this reason authentication can’t be provided by Ephemeral DH, another mechanism must be used: TLS server signs the content of its server key exchange message that contains the ephemeral public key.</p><a href="#fnref2">↩︎</a></li></ol></div></div><div class="metadata"><div class="date" title="Zettel date"><time datetime="2020-01-13T18:06">2020-01-13</time></div></div></article><nav class="ui attached segment deemphasized backlinksPane" id="neuron-backlinks-pane"><h3 class="ui header">Backlinks</h3><ul class="backlinks"><li><span class="zettel-link-container cf"><span class="zettel-link" title="2021-01-02T21:34"><a href="saml.html">SAML</a></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc">message integrity &amp; confidentiality → <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span> recommended</div></li><li class="item"><div class="pandoc">when relying party requests an assertion from an asserting party bi-later authentication is required → <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span> recommended</div></li></ul></li><li><span class="zettel-link-container cf"><span class="zettel-link" title="2020-12-26T21:32"><a href="oauth2.html">OAuth 2.0</a></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc"><p>OAuth 2.0 relies on HTTP+TLS(<span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span>). It is not an authentication protocol but can be used to build one. An implementation is OpenID Connect which relies on OAuth 2.0.</p></div></li></ul></li><li><span class="zettel-link-container cf"><span class="zettel-link" title="2020-12-11T15:27"><a href="icns.html">Introduction to network and computer security</a></span></span><ul class="context-list" style="zoom: 85%;"></ul></li></ul><h3 class="ui header"><span title="Backlinks from folgezettel parents">Uplinks</span></h3><ul class="backlinks"><li><span class="zettel-link-container folge"><span class="zettel-link" title="2021-01-04T09:02"><a href="asymmetricKeyEncryption.html">Asymmetric key encryption</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc"><p>In order to mitigate the cons a digital signature can be used. A data item that vouches the origin and the integrity of the message. But the use of digital signature introduce a new problem: who guarantees that the one using the key is entitled to do so? This can be solved using digital certificates<span data-nosnippet=""><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></span></p><div id="footnotes"><ol><li id="fn1"><p>you can read more about digital certificates in <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span></p><a href="#fnref1">↩︎</a></li></ol></div></div></li><li class="item"><div class="pandoc"><p>you can read more about digital certificates in <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span></p></div></li></ul></li><li><span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-14T14:59"><a href="digitalCertificate.html">Digital certificates</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc"><p>Digital certificates are used in <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="sslTls.html">SSL and TLS</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span> and <span class="zettel-link-container folge"><span class="zettel-link" title="2020-01-13T18:06"><a href="cie3.html">CIE 3.0</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span></p></div></li></ul></li></ul></nav><nav class="ui attached segment deemphasized bottomPane" id="neuron-tags-pane"><div><span class="ui basic label zettel-tag" title="Tag">asymmetric-key</span><span class="ui basic label zettel-tag" title="Tag">cryptography</span><span class="ui basic label zettel-tag" title="Tag">ssl</span><span class="ui basic label zettel-tag" title="Tag">tls</span><span class="ui basic label zettel-tag" title="Tag">university/introductionComputerNetworkSecurity/cryptography</span></div></nav><nav class="ui bottom attached icon compact inverted menu black" id="neuron-nav-bar"><!--replace-start-9--><a class="item" href="." title="Home"><i class="home icon"></i></a><!--replace-end-9--><a class="item" href="https://github.com/fedeizzo/zettelkasten/edit/master./icns/sslTls.md" title="Edit this page"><i class="edit icon"></i></a><a class="right item" href="impulse.html" title="Open Impulse"><i class="wave square icon"></i></a></nav></div></div><!--replace-end-6--><!--replace-end-3--><!--replace-end-2--><div class="ui center aligned container footer-version"><div class="ui tiny image"><a href="https://neuron.zettel.page"><img alt="logo" src="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" title="Generated by Neuron 1.9.25.0" /></a></div></div></div></body></html>